2025-12-19 22:55:22,965 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-19 22:55:22,966 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-19 22:55:22,966 - ASHRAE_MLOps_Pipeline - ERROR - Configuration error: Missing key 'db' in configs/ingestion_config.yaml
2025-12-19 22:57:14,856 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-19 22:57:14,857 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-19 22:57:15,077 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-19 22:57:15,078 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-19 22:57:15,078 - src.database.schema_manager - INFO - Initializing Production Star Schema...
2025-12-19 22:57:15,097 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '123!@localhost' ([Errno -2] Name or service not known)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/socket.py", line 839, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/socket.py", line 974, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '123!@localhost' ([Errno -2] Name or service not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 74, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 31, in run
    self.schema_manager.create_production_schema()
  File "/home/bishesh/mlops/src/database/schema_manager.py", line 43, in create_production_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3153, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '123!@localhost' ([Errno -2] Name or service not known)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-19 22:58:14,641 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-19 22:58:14,641 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-19 22:58:14,684 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-19 22:58:14,684 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-19 22:58:14,684 - src.database.schema_manager - INFO - Initializing Production Star Schema...
2025-12-19 22:58:14,757 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: CREATE TABLE IF NOT EXISTS fact_energy_usage (building_id INT,
    meter TINYINT,
    timestamp DATETIME,
    meter_reading FLOAT) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 74, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 31, in run
    self.schema_manager.create_production_schema()
  File "/home/bishesh/mlops/src/database/schema_manager.py", line 46, in create_production_schema
    conn.execute(text(sql))
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: CREATE TABLE IF NOT EXISTS fact_energy_usage (building_id INT,
    meter TINYINT,
    timestamp DATETIME,
    meter_reading FLOAT) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-19 22:59:27,517 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-19 22:59:27,518 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-19 22:59:27,522 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-19 22:59:27,523 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-19 22:59:27,523 - src.database.schema_manager - INFO - Initializing Production Star Schema for ColumnStore...
2025-12-19 22:59:27,558 - src.database.schema_manager - ERROR - Schema creation failed. Ensure ColumnStore engine is active: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `fact_energy_usage` (
    `building_id` INT,
    `meter` INT,
    `timestamp` DATETIME,
    `meter_reading` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-19 22:59:27,561 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `fact_energy_usage` (
    `building_id` INT,
    `meter` INT,
    `timestamp` DATETIME,
    `meter_reading` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 74, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 31, in run
    self.schema_manager.create_production_schema()
  File "/home/bishesh/mlops/src/database/schema_manager.py", line 64, in create_production_schema
    conn.execute(text(sql))
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `fact_energy_usage` (
    `building_id` INT,
    `meter` INT,
    `timestamp` DATETIME,
    `meter_reading` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-19 23:11:08,586 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-19 23:11:08,586 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-19 23:11:08,621 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-19 23:11:08,622 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-19 23:11:08,622 - src.database.schema_manager - INFO - Initializing Production Star Schema for ColumnStore...
2025-12-19 23:11:08,675 - src.database.schema_manager - ERROR - Schema creation failed. Ensure ColumnStore engine is active: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `fact_energy_usage` (
    `building_id` INT,
    `meter` INT,
    `timestamp` DATETIME,
    `meter_reading` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-19 23:11:08,676 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `fact_energy_usage` (
    `building_id` INT,
    `meter` INT,
    `timestamp` DATETIME,
    `meter_reading` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 74, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 31, in run
    self.schema_manager.create_production_schema()
  File "/home/bishesh/mlops/src/database/schema_manager.py", line 64, in create_production_schema
    conn.execute(text(sql))
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `fact_energy_usage` (
    `building_id` INT,
    `meter` INT,
    `timestamp` DATETIME,
    `meter_reading` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-19 23:17:04,499 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-19 23:17:04,499 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-19 23:17:04,517 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-19 23:17:04,517 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-19 23:17:04,518 - src.database.schema_manager - INFO - Initializing Production Star Schema for ColumnStore...
2025-12-19 23:17:04,535 - src.database.schema_manager - ERROR - Schema creation failed. Ensure ColumnStore engine is active: 'train'
2025-12-19 23:17:04,535 - ASHRAE_MLOps_Pipeline - ERROR - Configuration error: Missing key 'train' in configs/ingestion_config.yaml
2025-12-19 23:17:21,725 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-19 23:17:21,726 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-19 23:17:21,729 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-19 23:17:21,730 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-19 23:17:21,730 - src.database.schema_manager - INFO - Initializing Production Star Schema for ColumnStore...
2025-12-19 23:17:21,747 - src.database.schema_manager - ERROR - Schema creation failed. Ensure ColumnStore engine is active: 'train'
2025-12-19 23:17:21,747 - ASHRAE_MLOps_Pipeline - ERROR - Configuration error: Missing key 'train' in configs/ingestion_config.yaml
2025-12-19 23:17:49,488 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-19 23:17:49,489 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-19 23:17:49,538 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-19 23:17:49,538 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-19 23:17:49,538 - src.database.schema_manager - INFO - Initializing Production Star Schema for ColumnStore...
2025-12-19 23:17:49,576 - src.database.schema_manager - ERROR - Schema creation failed. Ensure ColumnStore engine is active: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `dim_building` (
    `site_id` INT,
    `building_id` INT,
    `primary_use` VARCHAR(255),
    `square_feet` INT,
    `year_built` FLOAT,
    `floor_count` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-19 23:17:49,577 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `dim_building` (
    `site_id` INT,
    `building_id` INT,
    `primary_use` VARCHAR(255),
    `square_feet` INT,
    `year_built` FLOAT,
    `floor_count` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 74, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 31, in run
    self.schema_manager.create_production_schema()
  File "/home/bishesh/mlops/src/database/schema_manager.py", line 64, in create_production_schema
    conn.execute(text(sql))
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `dim_building` (
    `site_id` INT,
    `building_id` INT,
    `primary_use` VARCHAR(255),
    `square_feet` INT,
    `year_built` FLOAT,
    `floor_count` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-19 23:18:28,527 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-19 23:18:28,527 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-19 23:18:28,553 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-19 23:18:28,553 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-19 23:18:28,553 - src.database.schema_manager - INFO - Initializing Production Star Schema for ColumnStore...
2025-12-19 23:18:28,603 - src.database.schema_manager - ERROR - Schema creation failed. Ensure ColumnStore engine is active: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `dim_building` (
    `site_id` INT,
    `building_id` INT,
    `primary_use` VARCHAR(255),
    `square_feet` INT,
    `year_built` FLOAT,
    `floor_count` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-19 23:18:28,605 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `dim_building` (
    `site_id` INT,
    `building_id` INT,
    `primary_use` VARCHAR(255),
    `square_feet` INT,
    `year_built` FLOAT,
    `floor_count` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 74, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 31, in run
    self.schema_manager.create_production_schema()
  File "/home/bishesh/mlops/src/database/schema_manager.py", line 64, in create_production_schema
    conn.execute(text(sql))
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `dim_building` (
    `site_id` INT,
    `building_id` INT,
    `primary_use` VARCHAR(255),
    `square_feet` INT,
    `year_built` FLOAT,
    `floor_count` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-19 23:24:25,428 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-19 23:24:25,429 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-19 23:24:25,433 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-19 23:24:25,434 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-19 23:24:25,434 - src.database.schema_manager - INFO - Initializing Production Star Schema for ColumnStore...
2025-12-19 23:24:25,554 - src.database.schema_manager - ERROR - Schema creation failed. Ensure ColumnStore engine is active: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `dim_building` (
    `site_id` INT,
    `building_id` INT,
    `primary_use` VARCHAR(255),
    `square_feet` INT,
    `year_built` FLOAT,
    `floor_count` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-19 23:24:25,554 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `dim_building` (
    `site_id` INT,
    `building_id` INT,
    `primary_use` VARCHAR(255),
    `square_feet` INT,
    `year_built` FLOAT,
    `floor_count` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 74, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 31, in run
    self.schema_manager.create_production_schema()
  File "/home/bishesh/mlops/src/database/schema_manager.py", line 64, in create_production_schema
    conn.execute(text(sql))
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `dim_building` (
    `site_id` INT,
    `building_id` INT,
    `primary_use` VARCHAR(255),
    `square_feet` INT,
    `year_built` FLOAT,
    `floor_count` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-20 19:19:30,034 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 19:19:30,035 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 19:19:30,263 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 19:19:30,264 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 19:19:30,264 - src.database.schema_manager - INFO - Initializing Production Star Schema for ColumnStore...
2025-12-20 19:19:30,469 - src.database.schema_manager - ERROR - Schema creation failed. Ensure ColumnStore engine is active: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `dim_building` (
    `site_id` INT,
    `building_id` INT,
    `primary_use` VARCHAR(255),
    `square_feet` INT,
    `year_built` FLOAT,
    `floor_count` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-20 19:19:30,470 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `dim_building` (
    `site_id` INT,
    `building_id` INT,
    `primary_use` VARCHAR(255),
    `square_feet` INT,
    `year_built` FLOAT,
    `floor_count` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 74, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 31, in run
    self.schema_manager.create_production_schema()
  File "/home/bishesh/mlops/src/database/schema_manager.py", line 64, in create_production_schema
    conn.execute(text(sql))
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: CREATE TABLE `dim_building` (
    `site_id` INT,
    `building_id` INT,
    `primary_use` VARCHAR(255),
    `square_feet` INT,
    `year_built` FLOAT,
    `floor_count` FLOAT
) ENGINE=ColumnStore;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-12-20 21:02:10,708 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:02:10,711 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:02:10,745 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:02:10,746 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: name 'SchemaManager' is not defined
Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 59, in run_ingestion_stage
    stage = IngestionStage(config)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 24, in __init__
    self.schema_manager = SchemaManager(self.db_client)
                          ^^^^^^^^^^^^^
NameError: name 'SchemaManager' is not defined
2025-12-20 21:02:33,265 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:02:33,266 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:02:33,292 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:02:33,292 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion (Lazy Creation)...
2025-12-20 21:02:33,292 - ASHRAE_MLOps_Pipeline - INFO - Ingestion stage completed successfully.
2025-12-20 21:03:55,419 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:03:55,420 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:03:55,453 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:03:55,453 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 21:03:55,453 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:03:55,529 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'SCHEMA ashrae_db' at line 1")
[SQL: SET SCHEMA ashrae_db]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 21:03:55,529 - src.ingestion.orchestrator - ERROR - Failed to ingest train: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'SCHEMA ashrae_db' at line 1")
[SQL: SET SCHEMA ashrae_db]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 21:03:55,530 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'SCHEMA ashrae_db' at line 1")
[SQL: SET SCHEMA ashrae_db]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'SCHEMA ashrae_db' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 69, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 51, in _ingest_to_production
    self.writer.write_chunk(chunk, table)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 26, in write_chunk
    conn.execute(text("SET SCHEMA ashrae_db"))
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'SCHEMA ashrae_db' at line 1")
[SQL: SET SCHEMA ashrae_db]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 21:05:52,007 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:05:52,007 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:05:52,025 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:05:52,025 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 21:05:52,026 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:05:52,094 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter SMALLINT, 
	timestamp DATETIME, 
	meter_reading FLOAT(23)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:05:52,095 - src.ingestion.orchestrator - ERROR - Failed to ingest train: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter SMALLINT, 
	timestamp DATETIME, 
	meter_reading FLOAT(23)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:05:52,095 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter SMALLINT, 
	timestamp DATETIME, 
	meter_reading FLOAT(23)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 69, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 51, in _ingest_to_production
    self.writer.write_chunk(chunk, table)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 36, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 997, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter SMALLINT, 
	timestamp DATETIME, 
	meter_reading FLOAT(23)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:07:06,540 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:07:06,540 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:07:06,569 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:07:06,569 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 21:07:06,569 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:07:06,645 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter SMALLINT, 
	timestamp DATETIME, 
	meter_reading FLOAT(23)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:07:06,645 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter SMALLINT, 
	timestamp DATETIME, 
	meter_reading FLOAT(23)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 36, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 997, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter SMALLINT, 
	timestamp DATETIME, 
	meter_reading FLOAT(23)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:08:28,293 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:08:28,293 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:08:28,312 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:08:28,313 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 21:08:28,313 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:08:28,383 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATETIME, 
	meter_reading FLOAT
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:08:28,383 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATETIME, 
	meter_reading FLOAT
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 50, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 997, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATETIME, 
	meter_reading FLOAT
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:11:36,463 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:11:36,464 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:11:36,486 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:11:36,486 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 21:11:36,486 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:11:36,552 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: DROP TABLE IF EXISTS `fact_energy_usage`]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:11:36,552 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: DROP TABLE IF EXISTS `fact_energy_usage`]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 52, in write_chunk
    self.truncate_table(table_name)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 28, in truncate_table
    conn.execute(text(f"DROP TABLE IF EXISTS `{table_name}`"))
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1815, 'Internal error: Cannot execute the statement. DBRM is read only!')
[SQL: DROP TABLE IF EXISTS `fact_energy_usage`]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:15:46,373 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:15:46,373 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:15:46,396 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:15:46,396 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 21:15:46,396 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:15:46,462 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATETIME, 
	meter_reading FLOAT
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:15:46,464 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATETIME, 
	meter_reading FLOAT
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 50, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 997, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATETIME, 
	meter_reading FLOAT
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:16:33,357 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:16:33,357 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:16:33,381 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:16:33,381 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 21:16:33,381 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:16:33,451 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATETIME, 
	meter_reading FLOAT
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:16:33,452 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATETIME, 
	meter_reading FLOAT
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 50, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 997, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATETIME, 
	meter_reading FLOAT
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:20:44,866 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:20:44,868 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:20:44,902 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:20:44,903 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 21:20:44,904 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:20:44,964 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: name 'text' is not defined
2025-12-20 21:20:44,964 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: name 'text' is not defined
Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 43, in write_chunk
    conn.execute(text("USE `ashrae_db`"))
                 ^^^^
NameError: name 'text' is not defined
2025-12-20 21:21:12,478 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:21:12,478 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:21:12,508 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:21:12,509 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 21:21:12,509 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:21:12,592 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading FLOAT
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:21:12,592 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading FLOAT
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 48, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 997, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading FLOAT
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:22:24,158 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:22:24,158 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:22:24,172 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:22:24,172 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 21:22:24,172 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:22:24,248 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:22:24,249 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 49, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 997, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:25:05,958 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:25:05,964 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:25:05,978 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:25:05,978 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 21:25:05,978 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:25:06,048 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:25:06,049 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 55, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 997, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:27:13,973 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:27:13,973 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:27:13,996 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:27:13,996 - src.ingestion.orchestrator - INFO - Starting Direct Ingestion...
2025-12-20 21:27:13,996 - src.ingestion.orchestrator - INFO - Ingesting train into fact_energy_usage...
2025-12-20 21:27:13,996 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:30:47,240 - src.ingestion.orchestrator - INFO - Ingesting building into dim_building...
2025-12-20 21:30:47,241 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/uilding_metadata.csv
2025-12-20 21:30:47,243 - src.ingestion.csv_reader - ERROR - Source file not found: ./Raw_Data/uilding_metadata.csv
2025-12-20 21:30:47,243 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: [Errno 2] No such file or directory: './Raw_Data/uilding_metadata.csv'
Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 52, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 22, in run
    metrics = self._ingest_file(file_info)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 36, in _ingest_file
    for chunk in reader.read_chunks():
  File "/home/bishesh/mlops/src/ingestion/csv_reader.py", line 30, in read_chunks
    reader = pd.read_csv(
             ^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './Raw_Data/uilding_metadata.csv'
2025-12-20 21:39:27,193 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:39:27,194 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:39:27,208 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:39:27,208 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 21:39:27,208 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:39:27,317 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:39:27,318 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 55, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 991, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:42:49,384 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-20 21:42:49,384 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-20 21:42:49,399 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-20 21:42:49,399 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-20 21:42:49,400 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-20 21:42:49,485 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-20 21:42:49,486 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 55, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 997, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-21 09:22:24,006 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-21 09:22:24,008 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-21 09:22:24,114 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-21 09:22:24,115 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-21 09:22:24,115 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-21 09:22:24,196 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 111] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-21 09:22:24,196 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 111] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/socket.py", line 863, in create_connection
    raise exceptions[0]
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/socket.py", line 848, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3309, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 111] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 48, in write_chunk
    with self.engine.begin() as conn:
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3249, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3285, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2448, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3309, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 111] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-22 09:32:03,710 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-22 09:32:03,712 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-22 09:32:03,887 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-22 09:32:03,888 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-22 09:32:03,888 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-22 09:32:04,877 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1698, "Access denied for user 'student'@'_gateway'")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-22 09:32:04,877 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1698, "Access denied for user 'student'@'_gateway'")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3309, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 681, in connect
    self._request_authentication()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 958, in _request_authentication
    auth_packet = self._read_packet()
                  ^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1698, "Access denied for user 'student'@'_gateway'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 48, in write_chunk
    with self.engine.begin() as conn:
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3249, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3285, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2448, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3309, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 681, in connect
    self._request_authentication()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 958, in _request_authentication
    auth_packet = self._read_packet()
                  ^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1698, "Access denied for user 'student'@'_gateway'")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-22 09:37:52,652 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-22 09:37:52,653 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-22 09:37:52,668 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-22 09:37:52,668 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-22 09:37:52,668 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-22 09:37:52,752 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-22 09:37:52,752 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 55, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 997, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATETIME, 
	meter_reading DOUBLE
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-22 09:49:02,548 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-22 09:49:02,549 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-22 09:49:02,564 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-22 09:49:02,564 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-22 09:49:02,564 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-22 09:49:02,686 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATE, 
	meter_reading DECIMAL(10, 2)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-22 09:49:02,686 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATE, 
	meter_reading DECIMAL(10, 2)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 56, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 997, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id BIGINT, 
	meter BIGINT, 
	timestamp DATE, 
	meter_reading DECIMAL(10, 2)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-22 09:49:29,844 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-22 09:49:29,845 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-22 09:49:29,861 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-22 09:49:29,861 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-22 09:49:29,861 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-22 09:49:29,941 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATE, 
	meter_reading DECIMAL(10, 2)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-22 09:49:29,942 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATE, 
	meter_reading DECIMAL(10, 2)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 56, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 997, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATE, 
	meter_reading DECIMAL(10, 2)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-22 09:50:10,458 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-22 09:50:10,458 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-22 09:50:10,473 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-22 09:50:10,474 - src.ingestion.orchestrator - INFO - Starting Direct-to-Production Ingestion...
2025-12-22 09:50:10,474 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-22 09:50:10,545 - src.ingestion.db_writer - ERROR - Error writing to table fact_energy_usage: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATE, 
	meter_reading DECIMAL(10, 2)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-22 09:50:10,547 - ASHRAE_MLOps_Pipeline - CRITICAL - Pipeline failed at stage [ingestion]: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATE, 
	meter_reading DECIMAL(10, 2)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bishesh/mlops/main.py", line 66, in main
    metrics = run_ingestion_stage(config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 64, in run_ingestion_stage
    return stage.run()
           ^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 33, in run
    metrics = self._ingest_to_production(file_info, batch_size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/mlops/src/ingestion/orchestrator.py", line 49, in _ingest_to_production
    self.writer.write_chunk(chunk, table, is_first_chunk=is_first)
  File "/home/bishesh/mlops/src/ingestion/db_writer.py", line 56, in write_chunk
    df.to_sql(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/core/generic.py", line 3109, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 2020, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 1924, in prep_table
    table.create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 997, in create
    self._execute_create()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 575, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 826, in _read_query_result
    result.read()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 1203, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/connections.py", line 782, in _read_packet
    packet.raise_for_error()
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/bishesh/miniconda3/envs/myenv/lib/python3.11/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1178, "The storage engine for the table doesn't support The syntax or the data type(s) is not supported by Columnstore. Please check the Columnstore syntax guide for supported syntax or data types.")
[SQL: 
CREATE TABLE fact_energy_usage (
	building_id INTEGER, 
	meter INTEGER, 
	timestamp DATE, 
	meter_reading DECIMAL(10, 2)
)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-22 14:46:04,528 - ASHRAE_MLOps_Pipeline - INFO - Configuration loaded from configs/ingestion_config.yaml
2025-12-22 14:46:04,529 - ASHRAE_MLOps_Pipeline - INFO - --- STAGE: DATA INGESTION ---
2025-12-22 14:46:04,578 - src.database.connection - INFO - Connected to MariaDB ColumnStore successfully.
2025-12-22 14:46:04,578 - src.ingestion.orchestrator - INFO - Starting Direct Ingestion...
2025-12-22 14:46:04,578 - src.ingestion.orchestrator - INFO - Ingesting train into fact_energy_usage...
2025-12-22 14:46:04,578 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/train.csv
2025-12-22 14:48:59,148 - src.ingestion.orchestrator - INFO - Ingesting building into dim_building...
2025-12-22 14:48:59,148 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/building_metadata.csv
2025-12-22 14:48:59,192 - src.ingestion.orchestrator - INFO - Ingesting weather into dim_weather...
2025-12-22 14:48:59,192 - src.ingestion.csv_reader - INFO - Starting chunked read for ./Raw_Data/weather_train.csv
2025-12-22 14:49:01,256 - ASHRAE_MLOps_Pipeline - INFO - Ingestion stage completed successfully.
